# 游댌 Detecci칩n de Servicios y Puertos

> **IMPORTANTE:** Los agentes de IA DEBEN detectar autom치ticamente los puertos antes de generar tests. NUNCA asumas el puerto.

---

## Comando de Detecci칩n Autom치tica

```bash
# Detecci칩n autom치tica completa
e2e observe --host localhost --ports 8000-9000 --docker

# Solo servicios locales
e2e observe --host localhost

# Detecci칩n manual
grep -r "port" services/<service>/src/main/resources/*.yml
```

---

## Ubicaciones Comunes de Puertos

### Spring Boot
- **Archivos:** `application.yml`, `application-{profile}.yml`
- **Puertos t칤picos:** 8080, 8081, 8085, 8090
- **Health:** `/actuator/health`, `/health`

### Node.js
- **Archivos:** `.env`, `config/*.js`, `server.js`
- **Puertos t칤picos:** 3000, 3001, 4000, 5000
- **Health:** `/health`, `/api/health`

### Python
- **Archivos:** `.env`, `settings.py`, `config.py`
- **Puertos t칤picos:** 5000, 8000, 8080
- **Health:** `/health`, `/api/health`, `/status`

### Docker Compose
- **Archivo:** `docker-compose.yml`
- **Puertos:** Definidos en el campo `ports`

---

## Verificar Servicio Activo

```bash
# Probar health endpoint
curl http://localhost:8080/actuator/health

# Probar endpoint gen칠rico
curl http://localhost:3000/health

# Verificar respuesta JSON
curl -s http://localhost:5000/health | jq
```

---

## Configurar URL Remota

### Servicio Local
```bash
e2e set url auth_service http://localhost:8085
```

### AWS API Gateway
```bash
e2e set url auth_service https://my-api.execute-api.us-east-1.amazonaws.com
```

### Azure
```bash
e2e set url auth_service https://my-api.azurewebsites.net
```

### GCP
```bash
e2e set url auth_service https://my-api.uc.gateway.dev
```

---

## Configurar Health Endpoint Personalizado

```bash
e2e set url auth_service http://localhost:8080 --health-endpoint /actuator/health
```

---

## Ver Configuraci칩n

```bash
# Ver toda la configuraci칩n
e2e set show

# Ver servicio espec칤fico
e2e set show auth_service
```

---

## Tips para Agentes

1. **SIEMPRE detecta primero** - No asumas ning칰n puerto
2. **Usa `e2e observe`** - Es la forma m치s confiable
3. **Verifica con curl** - Confirma que el servicio responde
4. **Actualiza e2e.conf** - Configura la URL correctamente
5. **Prueba el health endpoint** - Aseg칰rate que el servicio est치 activo

---

## Errores Comunes

### "Connection refused"
- El servicio no est치 corriendo
- Puerto incorrecto
- Firewall bloqueando

### "Service unavailable"
- El servicio est치 ca칤do
- Health endpoint incorrecto

### "404 Not Found"
- Endpoint incorrecto
- El path base ha cambiado
