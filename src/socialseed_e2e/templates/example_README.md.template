# ${project_name} - E2E Tests

End-to-end tests for APIs using **socialseed-e2e** framework.

## ğŸš€ Quick Start (Works Out of the Box!)

This project includes a working example that uses the built-in mock server.

### Option 1: Using e2e CLI

```bash
# Install dependencies
pip install -r requirements.txt
playwright install chromium

# Run tests - the mock server will start automatically
e2e run

# Or run with the example service specifically
e2e run --service example
```

### Option 2: Using pytest directly

```bash
# Run tests with pytest
pytest tests/ -v

# Or run specific test
pytest tests/example_test.py -v
```

### What happens next?

1. The mock API server starts automatically on `http://localhost:8765`
2. Tests run against the mock server
3. Results are displayed in the console

---

## ğŸŒ€ Demo APIs Available

Install additional demo APIs with different protocols:

```bash
e2e install-demo
```

This installs demo APIs in the `demos/` folder:

| API | Port | Protocol | Description |
|-----|------|----------|-------------|
| REST | 5000 | HTTP | Basic CRUD operations |
| gRPC | 50051 | Protocol Buffers | gRPC service |
| WebSocket | 50052 | WS | Real-time messaging |
| Auth | 5003 | HTTP | JWT Bearer authentication |

### Running Demo APIs

```bash
# REST Demo
python demos/rest/api-rest-demo.py

# gRPC Demo (requires: pip install grpcio grpcio-tools)
python demos/grpc/api-grpc-demo.py

# WebSocket Demo (requires: pip install aiohttp)
python demos/websocket/api-websocket-demo.py

# Auth Demo (requires: pip install pyjwt cryptography)
python demos/auth/api-auth-demo.py
```

### Demo Credentials (Auth API)
- Admin: `admin` / `admin123`
- User: `user1` / `user123`
- Moderator: `moderator1` / `mod123`

## ğŸ“ Project Structure

```
${project_name}/
â”œâ”€â”€ e2e.conf                   # Main configuration file
â”œâ”€â”€ socialseed.config.yaml     # Alternative YAML config
â”œâ”€â”€ pyproject.toml            # Project metadata & pytest config
â”œâ”€â”€ conftest.py               # Pytest fixtures (mock server)
â”œâ”€â”€ requirements.txt          # Python dependencies
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ example_test.py       # Example test (runs with mock server)
â”œâ”€â”€ services/
â”‚   â””â”€â”€ example/              # Example service
â”‚       â”œâ”€â”€ example_page.py   # Service page class
â”‚       â”œâ”€â”€ data_schema.py    # DTOs and constants
â”‚       â””â”€â”€ modules/          # Test modules
â”‚           â”œâ”€â”€ 01_health.py
â”‚           â””â”€â”€ 02_create.py
â”œâ”€â”€ .github/workflows/
â”‚   â””â”€â”€ e2e.yml              # GitHub Actions workflow
â””â”€â”€ README.md                 # This file
```

## ğŸ”§ Configuration

### Mock Server

The project is pre-configured to use the mock server at `http://localhost:8765`.

Default endpoints:
- `GET /health` - Health check
- `GET /api/users` - List users
- `POST /api/users` - Create user
- `GET /api/users/{id}` - Get user
- `PUT /api/users/{id}` - Update user
- `DELETE /api/users/{id}` - Delete user
- `POST /api/auth/login` - Login
- `POST /api/auth/register` - Register

Default credentials:
- Admin: `admin@example.com` / `admin123`
- User: `user@example.com` / `user123`

### Custom Configuration

Edit `e2e.conf` to change the API base URL:

```yaml
services:
  example:
    base_url: http://your-api:8080
    health_endpoint: /health
```

## ğŸ“ Writing Tests

### Create a New Service

```bash
e2e new-service my-api --base-url http://localhost:8080
```

### Create a New Test

```bash
e2e new-test login --service my-api
```

### Test Template

```python
from playwright.sync_api import APIResponse

def run(page: 'MyApiPage') -> APIResponse:
    # Your test logic here
    response = page.get("/health")
    assert response.ok
    return response
```

## ğŸ”„ CI/CD

The project includes a GitHub Actions workflow (`.github/workflows/e2e.yml`).

Push to GitHub and the workflow will automatically run tests on:
- Every push to main/master
- Every pull request

## ğŸ³ Docker

```bash
docker build -t ${project_name}-e2e .
docker run --rm ${project_name}-e2e e2e run
```

## ğŸ“š Documentation

- [socialseed-e2e Docs](https://daironpf.github.io/socialseed-e2e/)
- [CLI Reference](https://daironpf.github.io/socialseed-e2e/cli-reference.html)
- [GitHub](https://github.com/daironpf/socialseed-e2e)

## ğŸ¤– AI Agent Support

This project includes AI documentation in the `.agent/` folder:
- `AGENT_GUIDE.md` - Guide for AI agents
- `FRAMEWORK_CONTEXT.md` - Framework context
- `WORKFLOW_GENERATION.md` - Test generation workflows
